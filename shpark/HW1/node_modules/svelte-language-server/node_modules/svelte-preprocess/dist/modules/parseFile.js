"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseFile=exports.getSrcContent=exports.resolveSrc=void 0;const fs_1=require("fs"),path_1=require("path"),language_1=require("./language");exports.resolveSrc=(a,b)=>path_1.resolve(path_1.dirname(a),b),exports.getSrcContent=a=>new Promise((b,c)=>{fs_1.readFile(a,(a,d)=>{a?c(a):b(d.toString())})});async function doesFileExist(a){return new Promise(b=>fs_1.access(a,0,a=>b(!a)))}exports.parseFile=async({attributes:a,filename:b,content:c},d)=>{const e=[];if(a.src&&0===c.trim().length){if("string"!=typeof a.src)throw new Error("src attribute must be string");let d=a.src;null==d.match(/^(https?:)?\/\//)&&(d=exports.resolveSrc(b,d),(await doesFileExist(d))?(c=await exports.getSrcContent(d),e.push(d)):console.warn(`[svelte-preprocess] The file  "${d}" was not found.`))}const{lang:f,alias:g}=language_1.getLanguage(a,d);return{filename:b,attributes:a,content:c,lang:f,alias:g,dependencies:e}};